<?php
unset($CFG);
global $CFG;
$CFG = new stdClass();

$CFG->dbtype    = 'mysqli';
$CFG->dblibrary = 'native';
$CFG->dbhost    = '{{ moodle_db_host }}';
$CFG->dbname    = '{{ moodle_db_name }}';
$CFG->dbuser    = '{{ moodle_db_user }}';
$CFG->dbpass    = '{{ moodle_db_password }}';
$CFG->prefix    = 'mdl_';

$CFG->wwwroot   = '{{ moodle_siteurl }}';
$CFG->dataroot  = '{{ moodle_datadir }}';
$CFG->directorypermissions = 02770;

/**
 * Reverse proxy (ALB/NLB) 対応
 * - ALB からの X-Forwarded-* を信頼
 * - TLS 終端が ALB の場合に https として振る舞う
 */
$CFG->reverseproxy = true;
$CFG->sslproxy = true;
$CFG->reverseproxyaddresses = ['10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16'];

require_once(__DIR__ . '/lib/setup.php');
